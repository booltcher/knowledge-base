---
outline: [2, 3]
tags: AWS
publishDate: 2022/03/25
---

# Storage Extras

## Snow Family

- 是一种高度安全的便携设备，用于在边缘收集和处理数据，或将数据迁入迁出 AWS
- 数据迁移：Snowcone，Snowball Edge，Snowmobile
- 边缘计算：Snowcone，Snowball Edge
- 为什么用 Snow Family 来做数据迁移？
  - 大量数据传出要花费很多钱，因为很慢

### Snowball Edge

- 物理数据传输方案：从 AWS 迁入迁出 TB 或 PB 的数据
- 是网络移动数据的替代方案
- 按照数据传输作业付费
- 具有计算功能，可以在数据迁入 Snowball 时对其进行预处理
- 提供块存储和 S3 兼容的对象存储
- 有两种类型：
  - Snowball 边缘存储优化：适用于块或 S3 兼容的对象存储的 80TB 硬盘容量
  - Snowball 边缘计算优化：适用于块或 S3 兼容的对象存储的 42TB 硬盘容量
- 用例：大型数据云迁移，停用数据中心，灾难恢复

### Snowcone & Snowcone SSD

- 小，便携设备，坚固耐用，安全可靠，可以承受恶劣环境，适用于少量数据
- 很轻：2.1kg
- 用于边缘计算、存储和数据传输
- 两种类型：
  - Snowcone：8TB HDD 存储
  - Snowcone SSD - 14TB SSD 存储
- 用于 Snowball 不适合的场景，比如空间受限的环境
- 必须自己提供电池和电缆
- 发回 AWS 有两种方式：
  - 离线的，通过运输将数据发送回去
  - 或将这个设备联网使用 AWS 数据同步发送数据

### Snowmobile

- 是一辆真正的卡车
- 传输艾字节的数据（1EB = 1000PB = 1000000TBs）
- 每个 Snowmobile 有 100PB 的容量，可以同时订购多个
- 高安全性：温度可控，GPS，24/7 视频监控
- 如果数据超过 10PB 时比 Snowball 好

### 使用步骤

1. 从控制台请求设备交付
2. 在自己的服务器上安装 snowball 客户端或 AWS OpsHub
3. 将 Snowball 连接到服务器并复制文件
4. 完成后运回设备
5. 数据将加载进 S3bucket
6. Snowball 被完全擦除

### 边缘计算

- 在数据在边缘位置创建的时候去处理数据
  - 例如：有一辆卡车在路上，或者有一艘船在海上，或地面上的采矿站，这些都可以称为边缘位置，因为它们可以产生数据，但是不一定可以连接到互联网
- 这些位置可能：
  - 连接受限
  - 无法访问互联网或无法使用计算能力
- 可以安装 Snowball Edge/Snowcone 设备来进行边缘计算
- 用例：
  - 预处理数据
  - 机器学习
  - 提前转码媒体流
- 最终可以寄回设备给 AWS

### 用于边缘计算的 Snow Family

- Snowcone & Snowcone SSD
- Snowball Edge - 计算优化
- Snowball Edge - 存储优化
- 所有这些设备可以在其中运行 EC2 实例或 Lambda 函数（使用 AWS IoT Greengrass）
- 长期部署可以获得折扣（1 或 3 年）

### AWS OpsHub

- 从历史长看，使用 Snow Family 设备，需要 CLI
- 所以 AWS 创造了 OpsHub，这是一个软件，安装在计算机上，一旦连接可以提供一个图形界面，可以连接到 Snow 设备来配置它们和使用它们
  - 解锁和配置单个或集群设备
  - 传输文件
  - 启动和管理实例
  - 监控设备指标
  - 启动兼容的 AWS 服务

### Snowball 到 Glacier

- Snowball 不能直接直接导入到 Glacier
- 要先使用 S3，然后创建一个生命周期策略，将这些对象转移到 Glacier

## FSx

- 可以在 AWS 上启动第三方高性能文件系统
- 完全托管的服务
- 比如：
  - FSx for Lustre
  - FSx for NetApp ONTAP
  - FSx for Windows File Server
  - FSx for OpenZFS

### FSx for Windows File Server

- 完全托管的 Window 文件服务器共享驱动器
- 支持 SMB 协议
- 支持集成 Microsoft Active Directory 获得安全性
- **可以将它们安装在 Linux EC2 实例上**
- 可以使用微软的分布式文件系统 DFS 将文件系统组合在一起
- 性能上 可以拓展到 10s of GB/s，数百万 IOPS，以及数百 PB 的数据
- 存储选项：
  - SSD：低延迟
  - HDD：更广泛的工作负载，更便宜，例如主目录或 CMS
- 可以通过私人连接从本地基础设施访问 FSx for Windows 文件服务器
- 可以配置为多 AZ 来实现高可用性
- 所有数据每天都会备份到 S3 用于灾难恢复

### FSx for Lustre

- Lustre 是用来做分布式文件系统的，用于大规模计算
- 从 Linux 和 cluster 衍生出来的
- 用于机器学习，高性能计算(HPC)
- 视频处理等应用程序，财务建模，电子设计自动化
- 性能上 可以拓展到 100s of GB/s，数百万 IOPS，亚毫秒延迟
- 存储选项：
  - SSD：低延迟，小型和随机文件操作
  - HDD：吞吐量密集型，用于大型和顺序文件操作
- 与 S3 无缝集成
  - 可以将 S3 作为一个文件系统来读取
  - 可以写或计算输出到 S3
- 可以使用 VPN 或从本地直接连接

### FSx for NetApp ONTAP

- AWS 上托管的文件系统
- 兼容 NFS，SMS，iSCSI 协议
- 对于不同的操作系统都兼容
- 存储会自动缩放和增长
- 复制，快照，低成本，可以做数据压缩，重复数据删除
- 可以时间点即时克隆，对于测试新的工作负载很有用

### FSx for OpenZFS

- AWS 上托管的文件系统
- 兼容 NFS（v3 v4 v4.1 v4.2）
- 对于不同的操作系统都兼容
- 至多 100 万 IOPS 延迟小于 0.5ms
- 快照，压缩，成本低
- 时间点即时克隆

### 文件系统部署选项

- 临时文件系统
  - 暂时的
  - 数据不会被复制
  - 高爆发力（6 倍于持久文件系统的速度，200MBps per TiB）
  - 用例：短期处理，优化成本
- 持久文件系统
  - 长期的
  - 数据会被复制在同一个 AZ
  - 几分钟内替换失败的
  - 用例：长期处理，存储敏感数据

## Storage Gateway

- 本地数据和云数据之前的桥梁
- 用例：
  - 灾难恢复：将本地数据恢复到云上
  - 备份和恢复
  - 低延迟文件访问
- 类型：
  - S3 文件网关
  - FSx 文件网关
  - 卷网关
  - 磁带网关

### S3 文件网关

- 可以使用 NFS 和 SMB 协议访问
- 最近使用的数据被缓存在文件网关
- 支持不同的 S3 存储类型
- 可以使用生命周期过渡到 S3 Glacier
- 需要为每个网关创建 IAM 角色
- **SMB 协议和 Active Directory 集成用于用户身份验证**

### Fsx 文件网关

- 对于经常访问的数据进行本地缓存
- Windows 本机兼容性：SMB NTFS AD
- 对群组文件共享非常有用

### 卷网关

- 使用 S3 支持的 iSCSI 协议块存储
- 由 EBS 快照备份，可以帮助恢复本地卷
- 两种卷网关：
  - 缓存卷：最近的数据低延迟
  - 存储卷：整个数据集都在本地，有一个到 S3 的备份计划

### 磁带网关

- 一些公司有：磁带备份系统使用者物理磁带
- 使用磁带网关在云中备份磁带
- 虚拟磁带库可以支持 S3 和 Glacier
- 使用 iSCSI 接口
- 与领先的备份软件供应商合作

### 硬件设备

- 要在公司的数据中心安装网关，但有时没有虚拟服务器运行这个额外的网关，就可以利用 AWS 的硬件
- 可以在 amazon.com 上购买
- 然后这个迷你服务器就进入你的基础设施，然后就可以将其设置为文件网关，卷网关或磁带网关
- 必须有足够的 CPU，内存，网络来保证 SSD 缓存资源正常运行
- 对于小型数据中心的日常 NFS 备份很有用

## Transfer Family

- 支持的协议：
  - FTP
  - FTPS
  - SFTP
- 完全托管的基础设施，具有高可拓展性，可靠性和高可用性(多 AZ)
- 定价：每小时每个规定的端点每千兆字节
- 可以存储和管理用户的凭据
- 也可以集成现有的认证系统（微软 AD，LDAP，Okta，Amazon Cognito）
- 用例：文件分享，共享公共数据集，CRM，ERP 等

## DataSync

- 将大量数据移入移除
  - 本地/其他云到 AWS - 需要一个代理在本地运行
  - AWS to AWS - 无需代理
- 可以同步到
  - S3
  - EFS
  - FSx
- 复制任务是不连续的，可以每小时、每天或每周运行一次
- 可以保留文件权限和元数据
- 一个代理每秒最多 10Gbps，也可以设置带宽限制

## AWS 存储总览

![AWS 存储总览](/src/assets/aws-storage-extra.png)
