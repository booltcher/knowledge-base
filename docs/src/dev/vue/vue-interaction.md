---
outline: [2, 3]
tags: Vue
publishDate: 2023/01/12
---

# 组件通信

## 总览

组件通信是组件化的精髓，大抵可分为三种场景 9 种方式：

| 组件关系      | 传递方式                                                                                                        |
| ------------- | :-------------------------------------------------------------------------------------------------------------- |
| 父传子(5)     | [`props`](#✨-props) [自定义事件](#✨-自定义事件) [实例法](#✨-实例法) [`v-model`](#✨-`v-model`) [插槽](#✨-插槽) |
| 祖孙之间(2)   | [透传](#✨-透传)[注入](#✨-注入)                                                                                |
| 任意组件间(2) | [集中状态管理](#✨-集中状态管理) [事件总线](#✨-事件总线)                                                        |

## ✨ `props`

> 适用于：父子组件

在选项式 API 中，子组件通过定义`props`属性来接收父组件传递来的数据。
在组合式 API 中，子组件使用`defineProps`方法来定义。

## ✨ 自定义事件

## ✨ 实例法
通过获取组件实例的方式来获取数据或调用方法。
- `$parent`
- `$children`
- `$refs`

## ✨ `v-model`

## ✨ 插槽

## ✨ 透传

## ✨ 注入

## ✨ 集中状态管理

## ✨ 事件总线

## `provide` / `inject`

> 适用于：祖先/后代

跨代传递数据，只要是后代都可以拿到。如果是静态数据，可以将`provide`定义为对象，如果是动态数据，可以定义为一个方法返回一个对象。

`inject`可以是一个数组，或者对象`key`为本地的绑定名，`value`为注入的属性名。

## `$parent`

::: warning 🌋
**为什么不推荐使用？有什么缺点？**

1. **紧耦合性（Tight Coupling）**：使用 **`$parent`** 会使组件和其父组件之间产生紧密耦合。这意味着子组件依赖于其特定父组件的结构和实现细节。这种紧耦合会增加组件间的依赖性，降低了组件的可重用性和可维护性。
2. **可读性差**：在大型应用中，使用 **`$parent`** 可能会使代码变得难以理解和维护。其他开发人员阅读代码时，可能难以确定 **`$parent`** 引用的确切父级组件是哪一个。
3. **不利于单元测试**：依赖 **`$parent`** 会使单元测试变得困难。如果组件依赖于其父级组件，那么在测试组件时需要模拟或者创建这些父级组件的实例，这会增加测试的复杂度。
4. **不稳定性**：当父组件结构发生变化时，比如父组件的层级结构调整或者某些父组件被删除，使用 **`$parent`** 的子组件可能会受到影响，导致代码不稳定。
5. **难以追踪状态变化**
   :::
